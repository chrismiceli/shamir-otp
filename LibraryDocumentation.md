# Introduction #
This is the documentation generated by doxygen and can be built using the source code by calling 'make'.



# Details #

## Data Structures ##
struct  	profile\_t
struct  	verification\_t
struct  	update\_t

## Enumerations ##
enum  	role\_t { SHAMIR\_GENERATOR, SHAMIR\_AUTHENTICATOR }

## Functions ##
  * void  print\_profile (const profile\_t profile)
  * int   load\_profile (profile\_t `*`profile, const char `*`filename)
  * int   save\_profile (const profile\_t profile, const char `*`filename)
  * int   check\_otp (const profile\_t profile, const mpz\_t otp)
  * void  get\_otp (mpz\_t rop, const profile\_t profile)
  * void  create\_authenticator\_profile (profile\_t `*`authenticator\_profile, const profile\_t generator\_profile)
  * void  create\_generator\_profile (profile\_t `*`generator\_profile, const long security\_bits)
  * void  generate\_update\_material (const profile\_t profile, update\_t `*`update)
  * void  update\_profile (profile\_t `*`profile, const mpz\_t authenticator\_material, const mpz\_t generator\_material)
  * int   verify\_update\_material (const profile\_t profile, const verification\_t verification, const mpz\_t update\_material)
  * void  generate\_verification\_material (const profile\_t profile, verification\_t `*`verification, const update\_t update)


## Enumeration Type Documentation ##
### enum role\_t ###

The type of a participant in the Shamir one-time password scheme.

Enumerator:
> SHAMIR\_GENERATOR

> The generator of the password.
> SHAMIR\_AUTHENTICATOR

> The authenticator of the password.

## Function Documentation ##
### int check\_otp(const profile\_t profile, const mpz\_t otp) ###

Check a one-time password to authenticate the user who provided this password.

Parameters:
  * profile:  Current profile to check the password against. This is the authenticator's profile that is associated with the generator's profile.
  * otp:   Shamir one-time password to check.

Returns:
> 0 if the password is valid, -1 otherwise.

### void create\_authenticator\_profile (profile\_t `*` authenticator\_profile, const profile\_t generator\_profile) ###

Generates a profile for an authenticator.

Create a profile for an authenticator from a generator\_profile and store it in authenticator\_profile.

Parameters:
  * authenticator\_profile:   Used to store the profile created from generator\_profile.
  * generator\_profile:    Used to create a profile for the authenticator.

### void create\_generator\_profile(profile\_t `*` generator\_profile, const long security\_bits) ###

Generates a profile for the generator (client).

Create a profile for a generator (client desiring future authentication) that has security\_bits of security.

Parameters:
  * generator\_profile: Used to store the created generator profile.
  * security\_bits: The number of bits of security provided.

### void generate\_update\_material (const profile\_t profile, update\_t `*`update) ###

Create update material.

Create material that is used by update\_profile to update a profile to have the next valid Shamir one-time password.

Parameters:
  * profile: Profile of the party creating the update material.
  * update: Used to store the resulting update material that can be used to update the password via update\_profile.

### void generate\_verification\_material (const profile\_t profile, verification\_t `*`verification, const update\_t update) ###

Generates material to be utilized to verify update material.

Populate verification with information for the other participating party associated with this profile.

Parameters:
  * profile: The profile of the one-time password currently in question.
  * verification: Structure to be populated with information to be utilized by the other participating member.
  * update: The update material that is going to be verified by the other party.

### void get\_otp (mpz\_t rop, const profile\_t profile) ###

Gets the current Shamir one-time password for the generator's profile.

Parameters:
  * rop: Used to store the Shamir one-time password extracted from profile.
  * profile: Profile used to extract the Shamir one-time password form.

### int load\_profile(profile\_t `*`profile, const char `*`filename) ###

Load a profile from disk.

Loads the Shamir one-time password profile from the file specified at filename into a profile.

Parameters:
  * profile: Used to store the loaded profile.
  * filename: Name of the file to load the profile from.

Returns:
> 0 if successful, -1 otherwise. errno is set appropriately

### void print\_profile(const profile\_t profile) ###

Prints a profile to standard out.

Parameters:
  * profile: Profile to be printed

### int save\_profile(const profile\_t profile, const char `*`filename) ###

Save a profile to disk.

Saves the Shamir one-time password profile specified at filename to the file on disk specified at filename.

Parameters:
  * profile: Profile written to disk.
  * filename: Name of the file to write the profile to.

Returns:
> 0 if successful, -1 otherwise. errno is set appropriately

### void update\_profile(profile\_t `*`profile, const mpz\_t authenticator\_material, const mpz\_t generator\_material) ###

Updates a profile to be ready for the next Shamir one-time password

Use material created via generate\_update\_material to update the provided profile.

Parameters:
  * profile: The profile to be updated in preparation for the next Shamir one-time password.
  * authenticator\_material: Material created by the authenticator from generate\_update\_material.
  * generator\_material: Material created by the generator from generate\_update\_material.

### int verify\_update\_material(const profile\_t profile, const verification\_t verification, const mpz\_t update\_material) ###

Verifies whether update material is corrupt or malicious.

Verifies whether the update material update\_material is valid in the given profile context with information provided by verification.

Parameters:
  * profile: The profile of the One-Time password that is desiring to be updated with the update material.
  * verification: Information provided by the other party used to determine the validity of the update\_material.
  * update\_material: The update material to be verified for authenticity.

Returns:
> 0 for successful verification, -1 otherwise.